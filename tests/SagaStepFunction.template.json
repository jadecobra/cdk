{
  "Resources": {
    "BookingsB1C24132": {
      "Type": "AWS::DynamoDB::Table",
      "Properties": {
        "KeySchema": [
          {
            "AttributeName": "booking_id",
            "KeyType": "HASH"
          },
          {
            "AttributeName": "booking_type",
            "KeyType": "RANGE"
          }
        ],
        "AttributeDefinitions": [
          {
            "AttributeName": "booking_id",
            "AttributeType": "S"
          },
          {
            "AttributeName": "booking_type",
            "AttributeType": "S"
          }
        ],
        "ProvisionedThroughput": {
          "ReadCapacityUnits": 5,
          "WriteCapacityUnits": 5
        }
      },
      "UpdateReplacePolicy": "Retain",
      "DeletionPolicy": "Retain"
    },
    "flightsreserveflightServiceRole459CF800": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com"
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "ManagedPolicyArns": [
          {
            "Fn::Join": [
              "",
              [
                "arn:",
                {
                  "Ref": "AWS::Partition"
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
              ]
            ]
          }
        ]
      }
    },
    "flightsreserveflightServiceRoleDefaultPolicy1B185C71": {
      "Type": "AWS::IAM::Policy",
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": [
                "dynamodb:BatchGetItem",
                "dynamodb:GetRecords",
                "dynamodb:GetShardIterator",
                "dynamodb:Query",
                "dynamodb:GetItem",
                "dynamodb:Scan",
                "dynamodb:ConditionCheckItem",
                "dynamodb:BatchWriteItem",
                "dynamodb:PutItem",
                "dynamodb:UpdateItem",
                "dynamodb:DeleteItem",
                "dynamodb:DescribeTable"
              ],
              "Effect": "Allow",
              "Resource": [
                {
                  "Fn::GetAtt": [
                    "BookingsB1C24132",
                    "Arn"
                  ]
                },
                {
                  "Ref": "AWS::NoValue"
                }
              ]
            }
          ],
          "Version": "2012-10-17"
        },
        "PolicyName": "flightsreserveflightServiceRoleDefaultPolicy1B185C71",
        "Roles": [
          {
            "Ref": "flightsreserveflightServiceRole459CF800"
          }
        ]
      }
    },
    "flightsreserveflight7BBF8BFB": {
      "Type": "AWS::Lambda::Function",
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Ref": "AssetParameters21d94be1cd6f1e9584629e926200f4dbfcc73c09a2dfcd6f984254297c59c9f1S3Bucket3E022A35"
          },
          "S3Key": {
            "Fn::Join": [
              "",
              [
                {
                  "Fn::Select": [
                    0,
                    {
                      "Fn::Split": [
                        "||",
                        {
                          "Ref": "AssetParameters21d94be1cd6f1e9584629e926200f4dbfcc73c09a2dfcd6f984254297c59c9f1S3VersionKey2F48AA09"
                        }
                      ]
                    }
                  ]
                },
                {
                  "Fn::Select": [
                    1,
                    {
                      "Fn::Split": [
                        "||",
                        {
                          "Ref": "AssetParameters21d94be1cd6f1e9584629e926200f4dbfcc73c09a2dfcd6f984254297c59c9f1S3VersionKey2F48AA09"
                        }
                      ]
                    }
                  ]
                }
              ]
            ]
          }
        },
        "Role": {
          "Fn::GetAtt": [
            "flightsreserveflightServiceRole459CF800",
            "Arn"
          ]
        },
        "Environment": {
          "Variables": {
            "TABLE_NAME": {
              "Ref": "BookingsB1C24132"
            }
          }
        },
        "Handler": "flights/reserve_flight.handler",
        "Runtime": "python3.9"
      },
      "DependsOn": [
        "flightsreserveflightServiceRoleDefaultPolicy1B185C71",
        "flightsreserveflightServiceRole459CF800"
      ]
    },
    "confirmFlightLambdaHandlerServiceRole45F91B6E": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com"
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "ManagedPolicyArns": [
          {
            "Fn::Join": [
              "",
              [
                "arn:",
                {
                  "Ref": "AWS::Partition"
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
              ]
            ]
          }
        ]
      }
    },
    "confirmFlightLambdaHandlerServiceRoleDefaultPolicyA7A08CCB": {
      "Type": "AWS::IAM::Policy",
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": [
                "dynamodb:BatchGetItem",
                "dynamodb:GetRecords",
                "dynamodb:GetShardIterator",
                "dynamodb:Query",
                "dynamodb:GetItem",
                "dynamodb:Scan",
                "dynamodb:ConditionCheckItem",
                "dynamodb:BatchWriteItem",
                "dynamodb:PutItem",
                "dynamodb:UpdateItem",
                "dynamodb:DeleteItem",
                "dynamodb:DescribeTable"
              ],
              "Effect": "Allow",
              "Resource": [
                {
                  "Fn::GetAtt": [
                    "BookingsB1C24132",
                    "Arn"
                  ]
                },
                {
                  "Ref": "AWS::NoValue"
                }
              ]
            }
          ],
          "Version": "2012-10-17"
        },
        "PolicyName": "confirmFlightLambdaHandlerServiceRoleDefaultPolicyA7A08CCB",
        "Roles": [
          {
            "Ref": "confirmFlightLambdaHandlerServiceRole45F91B6E"
          }
        ]
      }
    },
    "confirmFlightLambdaHandler96C3663F": {
      "Type": "AWS::Lambda::Function",
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Ref": "AssetParameters8c25bcf969d5c44db3786e06e9654cbaeb8195315e50b77ec96e7a35924d3893S3Bucket3CA48617"
          },
          "S3Key": {
            "Fn::Join": [
              "",
              [
                {
                  "Fn::Select": [
                    0,
                    {
                      "Fn::Split": [
                        "||",
                        {
                          "Ref": "AssetParameters8c25bcf969d5c44db3786e06e9654cbaeb8195315e50b77ec96e7a35924d3893S3VersionKey880BCBF5"
                        }
                      ]
                    }
                  ]
                },
                {
                  "Fn::Select": [
                    1,
                    {
                      "Fn::Split": [
                        "||",
                        {
                          "Ref": "AssetParameters8c25bcf969d5c44db3786e06e9654cbaeb8195315e50b77ec96e7a35924d3893S3VersionKey880BCBF5"
                        }
                      ]
                    }
                  ]
                }
              ]
            ]
          }
        },
        "Role": {
          "Fn::GetAtt": [
            "confirmFlightLambdaHandlerServiceRole45F91B6E",
            "Arn"
          ]
        },
        "Environment": {
          "Variables": {
            "TABLE_NAME": {
              "Ref": "BookingsB1C24132"
            }
          }
        },
        "Handler": "flights/confirmFlight.handler",
        "Runtime": "nodejs12.x"
      },
      "DependsOn": [
        "confirmFlightLambdaHandlerServiceRoleDefaultPolicyA7A08CCB",
        "confirmFlightLambdaHandlerServiceRole45F91B6E"
      ]
    },
    "cancelFlightLambdaHandlerServiceRole7F2439CB": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com"
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "ManagedPolicyArns": [
          {
            "Fn::Join": [
              "",
              [
                "arn:",
                {
                  "Ref": "AWS::Partition"
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
              ]
            ]
          }
        ]
      }
    },
    "cancelFlightLambdaHandlerServiceRoleDefaultPolicy59295FBF": {
      "Type": "AWS::IAM::Policy",
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": [
                "dynamodb:BatchGetItem",
                "dynamodb:GetRecords",
                "dynamodb:GetShardIterator",
                "dynamodb:Query",
                "dynamodb:GetItem",
                "dynamodb:Scan",
                "dynamodb:ConditionCheckItem",
                "dynamodb:BatchWriteItem",
                "dynamodb:PutItem",
                "dynamodb:UpdateItem",
                "dynamodb:DeleteItem",
                "dynamodb:DescribeTable"
              ],
              "Effect": "Allow",
              "Resource": [
                {
                  "Fn::GetAtt": [
                    "BookingsB1C24132",
                    "Arn"
                  ]
                },
                {
                  "Ref": "AWS::NoValue"
                }
              ]
            }
          ],
          "Version": "2012-10-17"
        },
        "PolicyName": "cancelFlightLambdaHandlerServiceRoleDefaultPolicy59295FBF",
        "Roles": [
          {
            "Ref": "cancelFlightLambdaHandlerServiceRole7F2439CB"
          }
        ]
      }
    },
    "cancelFlightLambdaHandler437EEC76": {
      "Type": "AWS::Lambda::Function",
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Ref": "AssetParameters8c25bcf969d5c44db3786e06e9654cbaeb8195315e50b77ec96e7a35924d3893S3Bucket3CA48617"
          },
          "S3Key": {
            "Fn::Join": [
              "",
              [
                {
                  "Fn::Select": [
                    0,
                    {
                      "Fn::Split": [
                        "||",
                        {
                          "Ref": "AssetParameters8c25bcf969d5c44db3786e06e9654cbaeb8195315e50b77ec96e7a35924d3893S3VersionKey880BCBF5"
                        }
                      ]
                    }
                  ]
                },
                {
                  "Fn::Select": [
                    1,
                    {
                      "Fn::Split": [
                        "||",
                        {
                          "Ref": "AssetParameters8c25bcf969d5c44db3786e06e9654cbaeb8195315e50b77ec96e7a35924d3893S3VersionKey880BCBF5"
                        }
                      ]
                    }
                  ]
                }
              ]
            ]
          }
        },
        "Role": {
          "Fn::GetAtt": [
            "cancelFlightLambdaHandlerServiceRole7F2439CB",
            "Arn"
          ]
        },
        "Environment": {
          "Variables": {
            "TABLE_NAME": {
              "Ref": "BookingsB1C24132"
            }
          }
        },
        "Handler": "flights/cancelFlight.handler",
        "Runtime": "nodejs12.x"
      },
      "DependsOn": [
        "cancelFlightLambdaHandlerServiceRoleDefaultPolicy59295FBF",
        "cancelFlightLambdaHandlerServiceRole7F2439CB"
      ]
    },
    "reserveHotelLambdaHandlerServiceRole452F23B7": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com"
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "ManagedPolicyArns": [
          {
            "Fn::Join": [
              "",
              [
                "arn:",
                {
                  "Ref": "AWS::Partition"
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
              ]
            ]
          }
        ]
      }
    },
    "reserveHotelLambdaHandlerServiceRoleDefaultPolicy18196942": {
      "Type": "AWS::IAM::Policy",
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": [
                "dynamodb:BatchGetItem",
                "dynamodb:GetRecords",
                "dynamodb:GetShardIterator",
                "dynamodb:Query",
                "dynamodb:GetItem",
                "dynamodb:Scan",
                "dynamodb:ConditionCheckItem",
                "dynamodb:BatchWriteItem",
                "dynamodb:PutItem",
                "dynamodb:UpdateItem",
                "dynamodb:DeleteItem",
                "dynamodb:DescribeTable"
              ],
              "Effect": "Allow",
              "Resource": [
                {
                  "Fn::GetAtt": [
                    "BookingsB1C24132",
                    "Arn"
                  ]
                },
                {
                  "Ref": "AWS::NoValue"
                }
              ]
            }
          ],
          "Version": "2012-10-17"
        },
        "PolicyName": "reserveHotelLambdaHandlerServiceRoleDefaultPolicy18196942",
        "Roles": [
          {
            "Ref": "reserveHotelLambdaHandlerServiceRole452F23B7"
          }
        ]
      }
    },
    "reserveHotelLambdaHandler020AE24A": {
      "Type": "AWS::Lambda::Function",
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Ref": "AssetParameters8c25bcf969d5c44db3786e06e9654cbaeb8195315e50b77ec96e7a35924d3893S3Bucket3CA48617"
          },
          "S3Key": {
            "Fn::Join": [
              "",
              [
                {
                  "Fn::Select": [
                    0,
                    {
                      "Fn::Split": [
                        "||",
                        {
                          "Ref": "AssetParameters8c25bcf969d5c44db3786e06e9654cbaeb8195315e50b77ec96e7a35924d3893S3VersionKey880BCBF5"
                        }
                      ]
                    }
                  ]
                },
                {
                  "Fn::Select": [
                    1,
                    {
                      "Fn::Split": [
                        "||",
                        {
                          "Ref": "AssetParameters8c25bcf969d5c44db3786e06e9654cbaeb8195315e50b77ec96e7a35924d3893S3VersionKey880BCBF5"
                        }
                      ]
                    }
                  ]
                }
              ]
            ]
          }
        },
        "Role": {
          "Fn::GetAtt": [
            "reserveHotelLambdaHandlerServiceRole452F23B7",
            "Arn"
          ]
        },
        "Environment": {
          "Variables": {
            "TABLE_NAME": {
              "Ref": "BookingsB1C24132"
            }
          }
        },
        "Handler": "hotel/reserveHotel.handler",
        "Runtime": "nodejs12.x"
      },
      "DependsOn": [
        "reserveHotelLambdaHandlerServiceRoleDefaultPolicy18196942",
        "reserveHotelLambdaHandlerServiceRole452F23B7"
      ]
    },
    "confirmHotelLambdaHandlerServiceRoleD5F8F90E": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com"
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "ManagedPolicyArns": [
          {
            "Fn::Join": [
              "",
              [
                "arn:",
                {
                  "Ref": "AWS::Partition"
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
              ]
            ]
          }
        ]
      }
    },
    "confirmHotelLambdaHandlerServiceRoleDefaultPolicy69537B84": {
      "Type": "AWS::IAM::Policy",
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": [
                "dynamodb:BatchGetItem",
                "dynamodb:GetRecords",
                "dynamodb:GetShardIterator",
                "dynamodb:Query",
                "dynamodb:GetItem",
                "dynamodb:Scan",
                "dynamodb:ConditionCheckItem",
                "dynamodb:BatchWriteItem",
                "dynamodb:PutItem",
                "dynamodb:UpdateItem",
                "dynamodb:DeleteItem",
                "dynamodb:DescribeTable"
              ],
              "Effect": "Allow",
              "Resource": [
                {
                  "Fn::GetAtt": [
                    "BookingsB1C24132",
                    "Arn"
                  ]
                },
                {
                  "Ref": "AWS::NoValue"
                }
              ]
            }
          ],
          "Version": "2012-10-17"
        },
        "PolicyName": "confirmHotelLambdaHandlerServiceRoleDefaultPolicy69537B84",
        "Roles": [
          {
            "Ref": "confirmHotelLambdaHandlerServiceRoleD5F8F90E"
          }
        ]
      }
    },
    "confirmHotelLambdaHandler882ACF2D": {
      "Type": "AWS::Lambda::Function",
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Ref": "AssetParameters8c25bcf969d5c44db3786e06e9654cbaeb8195315e50b77ec96e7a35924d3893S3Bucket3CA48617"
          },
          "S3Key": {
            "Fn::Join": [
              "",
              [
                {
                  "Fn::Select": [
                    0,
                    {
                      "Fn::Split": [
                        "||",
                        {
                          "Ref": "AssetParameters8c25bcf969d5c44db3786e06e9654cbaeb8195315e50b77ec96e7a35924d3893S3VersionKey880BCBF5"
                        }
                      ]
                    }
                  ]
                },
                {
                  "Fn::Select": [
                    1,
                    {
                      "Fn::Split": [
                        "||",
                        {
                          "Ref": "AssetParameters8c25bcf969d5c44db3786e06e9654cbaeb8195315e50b77ec96e7a35924d3893S3VersionKey880BCBF5"
                        }
                      ]
                    }
                  ]
                }
              ]
            ]
          }
        },
        "Role": {
          "Fn::GetAtt": [
            "confirmHotelLambdaHandlerServiceRoleD5F8F90E",
            "Arn"
          ]
        },
        "Environment": {
          "Variables": {
            "TABLE_NAME": {
              "Ref": "BookingsB1C24132"
            }
          }
        },
        "Handler": "hotel/confirmHotel.handler",
        "Runtime": "nodejs12.x"
      },
      "DependsOn": [
        "confirmHotelLambdaHandlerServiceRoleDefaultPolicy69537B84",
        "confirmHotelLambdaHandlerServiceRoleD5F8F90E"
      ]
    },
    "cancelHotelLambdaHandlerServiceRole4815D152": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com"
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "ManagedPolicyArns": [
          {
            "Fn::Join": [
              "",
              [
                "arn:",
                {
                  "Ref": "AWS::Partition"
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
              ]
            ]
          }
        ]
      }
    },
    "cancelHotelLambdaHandlerServiceRoleDefaultPolicy58EA01C9": {
      "Type": "AWS::IAM::Policy",
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": [
                "dynamodb:BatchGetItem",
                "dynamodb:GetRecords",
                "dynamodb:GetShardIterator",
                "dynamodb:Query",
                "dynamodb:GetItem",
                "dynamodb:Scan",
                "dynamodb:ConditionCheckItem",
                "dynamodb:BatchWriteItem",
                "dynamodb:PutItem",
                "dynamodb:UpdateItem",
                "dynamodb:DeleteItem",
                "dynamodb:DescribeTable"
              ],
              "Effect": "Allow",
              "Resource": [
                {
                  "Fn::GetAtt": [
                    "BookingsB1C24132",
                    "Arn"
                  ]
                },
                {
                  "Ref": "AWS::NoValue"
                }
              ]
            }
          ],
          "Version": "2012-10-17"
        },
        "PolicyName": "cancelHotelLambdaHandlerServiceRoleDefaultPolicy58EA01C9",
        "Roles": [
          {
            "Ref": "cancelHotelLambdaHandlerServiceRole4815D152"
          }
        ]
      }
    },
    "cancelHotelLambdaHandler09F13EF6": {
      "Type": "AWS::Lambda::Function",
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Ref": "AssetParameters8c25bcf969d5c44db3786e06e9654cbaeb8195315e50b77ec96e7a35924d3893S3Bucket3CA48617"
          },
          "S3Key": {
            "Fn::Join": [
              "",
              [
                {
                  "Fn::Select": [
                    0,
                    {
                      "Fn::Split": [
                        "||",
                        {
                          "Ref": "AssetParameters8c25bcf969d5c44db3786e06e9654cbaeb8195315e50b77ec96e7a35924d3893S3VersionKey880BCBF5"
                        }
                      ]
                    }
                  ]
                },
                {
                  "Fn::Select": [
                    1,
                    {
                      "Fn::Split": [
                        "||",
                        {
                          "Ref": "AssetParameters8c25bcf969d5c44db3786e06e9654cbaeb8195315e50b77ec96e7a35924d3893S3VersionKey880BCBF5"
                        }
                      ]
                    }
                  ]
                }
              ]
            ]
          }
        },
        "Role": {
          "Fn::GetAtt": [
            "cancelHotelLambdaHandlerServiceRole4815D152",
            "Arn"
          ]
        },
        "Environment": {
          "Variables": {
            "TABLE_NAME": {
              "Ref": "BookingsB1C24132"
            }
          }
        },
        "Handler": "hotel/cancelHotel.handler",
        "Runtime": "nodejs12.x"
      },
      "DependsOn": [
        "cancelHotelLambdaHandlerServiceRoleDefaultPolicy58EA01C9",
        "cancelHotelLambdaHandlerServiceRole4815D152"
      ]
    },
    "takePaymentLambdaHandlerServiceRole56CA2808": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com"
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "ManagedPolicyArns": [
          {
            "Fn::Join": [
              "",
              [
                "arn:",
                {
                  "Ref": "AWS::Partition"
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
              ]
            ]
          }
        ]
      }
    },
    "takePaymentLambdaHandlerServiceRoleDefaultPolicy95F3D626": {
      "Type": "AWS::IAM::Policy",
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": [
                "dynamodb:BatchGetItem",
                "dynamodb:GetRecords",
                "dynamodb:GetShardIterator",
                "dynamodb:Query",
                "dynamodb:GetItem",
                "dynamodb:Scan",
                "dynamodb:ConditionCheckItem",
                "dynamodb:BatchWriteItem",
                "dynamodb:PutItem",
                "dynamodb:UpdateItem",
                "dynamodb:DeleteItem",
                "dynamodb:DescribeTable"
              ],
              "Effect": "Allow",
              "Resource": [
                {
                  "Fn::GetAtt": [
                    "BookingsB1C24132",
                    "Arn"
                  ]
                },
                {
                  "Ref": "AWS::NoValue"
                }
              ]
            }
          ],
          "Version": "2012-10-17"
        },
        "PolicyName": "takePaymentLambdaHandlerServiceRoleDefaultPolicy95F3D626",
        "Roles": [
          {
            "Ref": "takePaymentLambdaHandlerServiceRole56CA2808"
          }
        ]
      }
    },
    "takePaymentLambdaHandlerB96529D4": {
      "Type": "AWS::Lambda::Function",
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Ref": "AssetParameters8c25bcf969d5c44db3786e06e9654cbaeb8195315e50b77ec96e7a35924d3893S3Bucket3CA48617"
          },
          "S3Key": {
            "Fn::Join": [
              "",
              [
                {
                  "Fn::Select": [
                    0,
                    {
                      "Fn::Split": [
                        "||",
                        {
                          "Ref": "AssetParameters8c25bcf969d5c44db3786e06e9654cbaeb8195315e50b77ec96e7a35924d3893S3VersionKey880BCBF5"
                        }
                      ]
                    }
                  ]
                },
                {
                  "Fn::Select": [
                    1,
                    {
                      "Fn::Split": [
                        "||",
                        {
                          "Ref": "AssetParameters8c25bcf969d5c44db3786e06e9654cbaeb8195315e50b77ec96e7a35924d3893S3VersionKey880BCBF5"
                        }
                      ]
                    }
                  ]
                }
              ]
            ]
          }
        },
        "Role": {
          "Fn::GetAtt": [
            "takePaymentLambdaHandlerServiceRole56CA2808",
            "Arn"
          ]
        },
        "Environment": {
          "Variables": {
            "TABLE_NAME": {
              "Ref": "BookingsB1C24132"
            }
          }
        },
        "Handler": "payment/takePayment.handler",
        "Runtime": "nodejs12.x"
      },
      "DependsOn": [
        "takePaymentLambdaHandlerServiceRoleDefaultPolicy95F3D626",
        "takePaymentLambdaHandlerServiceRole56CA2808"
      ]
    },
    "refundPaymentLambdaHandlerServiceRole62F72F0D": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com"
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "ManagedPolicyArns": [
          {
            "Fn::Join": [
              "",
              [
                "arn:",
                {
                  "Ref": "AWS::Partition"
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
              ]
            ]
          }
        ]
      }
    },
    "refundPaymentLambdaHandlerServiceRoleDefaultPolicy39778F0D": {
      "Type": "AWS::IAM::Policy",
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": [
                "dynamodb:BatchGetItem",
                "dynamodb:GetRecords",
                "dynamodb:GetShardIterator",
                "dynamodb:Query",
                "dynamodb:GetItem",
                "dynamodb:Scan",
                "dynamodb:ConditionCheckItem",
                "dynamodb:BatchWriteItem",
                "dynamodb:PutItem",
                "dynamodb:UpdateItem",
                "dynamodb:DeleteItem",
                "dynamodb:DescribeTable"
              ],
              "Effect": "Allow",
              "Resource": [
                {
                  "Fn::GetAtt": [
                    "BookingsB1C24132",
                    "Arn"
                  ]
                },
                {
                  "Ref": "AWS::NoValue"
                }
              ]
            }
          ],
          "Version": "2012-10-17"
        },
        "PolicyName": "refundPaymentLambdaHandlerServiceRoleDefaultPolicy39778F0D",
        "Roles": [
          {
            "Ref": "refundPaymentLambdaHandlerServiceRole62F72F0D"
          }
        ]
      }
    },
    "refundPaymentLambdaHandler932D11D5": {
      "Type": "AWS::Lambda::Function",
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Ref": "AssetParameters8c25bcf969d5c44db3786e06e9654cbaeb8195315e50b77ec96e7a35924d3893S3Bucket3CA48617"
          },
          "S3Key": {
            "Fn::Join": [
              "",
              [
                {
                  "Fn::Select": [
                    0,
                    {
                      "Fn::Split": [
                        "||",
                        {
                          "Ref": "AssetParameters8c25bcf969d5c44db3786e06e9654cbaeb8195315e50b77ec96e7a35924d3893S3VersionKey880BCBF5"
                        }
                      ]
                    }
                  ]
                },
                {
                  "Fn::Select": [
                    1,
                    {
                      "Fn::Split": [
                        "||",
                        {
                          "Ref": "AssetParameters8c25bcf969d5c44db3786e06e9654cbaeb8195315e50b77ec96e7a35924d3893S3VersionKey880BCBF5"
                        }
                      ]
                    }
                  ]
                }
              ]
            ]
          }
        },
        "Role": {
          "Fn::GetAtt": [
            "refundPaymentLambdaHandlerServiceRole62F72F0D",
            "Arn"
          ]
        },
        "Environment": {
          "Variables": {
            "TABLE_NAME": {
              "Ref": "BookingsB1C24132"
            }
          }
        },
        "Handler": "payment/refundPayment.handler",
        "Runtime": "nodejs12.x"
      },
      "DependsOn": [
        "refundPaymentLambdaHandlerServiceRoleDefaultPolicy39778F0D",
        "refundPaymentLambdaHandlerServiceRole62F72F0D"
      ]
    },
    "BookingSagaRole82982544": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": {
                  "Fn::FindInMap": [
                    "ServiceprincipalMap",
                    {
                      "Ref": "AWS::Region"
                    },
                    "states"
                  ]
                }
              }
            }
          ],
          "Version": "2012-10-17"
        }
      }
    },
    "BookingSagaRoleDefaultPolicy6595FE9E": {
      "Type": "AWS::IAM::Policy",
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": "lambda:InvokeFunction",
              "Effect": "Allow",
              "Resource": {
                "Fn::GetAtt": [
                  "reserveHotelLambdaHandler020AE24A",
                  "Arn"
                ]
              }
            },
            {
              "Action": "lambda:InvokeFunction",
              "Effect": "Allow",
              "Resource": {
                "Fn::GetAtt": [
                  "flightsreserveflight7BBF8BFB",
                  "Arn"
                ]
              }
            },
            {
              "Action": "lambda:InvokeFunction",
              "Effect": "Allow",
              "Resource": {
                "Fn::GetAtt": [
                  "takePaymentLambdaHandlerB96529D4",
                  "Arn"
                ]
              }
            },
            {
              "Action": "lambda:InvokeFunction",
              "Effect": "Allow",
              "Resource": {
                "Fn::GetAtt": [
                  "confirmHotelLambdaHandler882ACF2D",
                  "Arn"
                ]
              }
            },
            {
              "Action": "lambda:InvokeFunction",
              "Effect": "Allow",
              "Resource": {
                "Fn::GetAtt": [
                  "confirmFlightLambdaHandler96C3663F",
                  "Arn"
                ]
              }
            },
            {
              "Action": "lambda:InvokeFunction",
              "Effect": "Allow",
              "Resource": {
                "Fn::GetAtt": [
                  "refundPaymentLambdaHandler932D11D5",
                  "Arn"
                ]
              }
            },
            {
              "Action": "lambda:InvokeFunction",
              "Effect": "Allow",
              "Resource": {
                "Fn::GetAtt": [
                  "cancelFlightLambdaHandler437EEC76",
                  "Arn"
                ]
              }
            },
            {
              "Action": "lambda:InvokeFunction",
              "Effect": "Allow",
              "Resource": {
                "Fn::GetAtt": [
                  "cancelHotelLambdaHandler09F13EF6",
                  "Arn"
                ]
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "PolicyName": "BookingSagaRoleDefaultPolicy6595FE9E",
        "Roles": [
          {
            "Ref": "BookingSagaRole82982544"
          }
        ]
      }
    },
    "BookingSagaFA991213": {
      "Type": "AWS::StepFunctions::StateMachine",
      "Properties": {
        "RoleArn": {
          "Fn::GetAtt": [
            "BookingSagaRole82982544",
            "Arn"
          ]
        },
        "DefinitionString": {
          "Fn::Join": [
            "",
            [
              "{\"StartAt\":\"ReserveHotel\",\"States\":{\"ReserveHotel\":{\"Next\":\"ReserveFlight\",\"Retry\":[{\"ErrorEquals\":[\"Lambda.ServiceException\",\"Lambda.AWSLambdaException\",\"Lambda.SdkClientException\"],\"IntervalSeconds\":2,\"MaxAttempts\":6,\"BackoffRate\":2}],\"Catch\":[{\"ErrorEquals\":[\"States.ALL\"],\"ResultPath\":\"$.ReserveHotelError\",\"Next\":\"CancelHotelReservation\"}],\"Type\":\"Task\",\"ResultPath\":\"$.ReserveHotelResult\",\"Resource\":\"arn:",
              {
                "Ref": "AWS::Partition"
              },
              ":states:::lambda:invoke\",\"Parameters\":{\"FunctionName\":\"",
              {
                "Fn::GetAtt": [
                  "reserveHotelLambdaHandler020AE24A",
                  "Arn"
                ]
              },
              "\",\"Payload.$\":\"$\"}},\"ReserveFlight\":{\"Next\":\"TakePayment\",\"Retry\":[{\"ErrorEquals\":[\"Lambda.ServiceException\",\"Lambda.AWSLambdaException\",\"Lambda.SdkClientException\"],\"IntervalSeconds\":2,\"MaxAttempts\":6,\"BackoffRate\":2}],\"Catch\":[{\"ErrorEquals\":[\"States.ALL\"],\"ResultPath\":\"$.ReserveFlightError\",\"Next\":\"CancelFlightReservation\"}],\"Type\":\"Task\",\"ResultPath\":\"$.ReserveFlightResult\",\"Resource\":\"arn:",
              {
                "Ref": "AWS::Partition"
              },
              ":states:::lambda:invoke\",\"Parameters\":{\"FunctionName\":\"",
              {
                "Fn::GetAtt": [
                  "flightsreserveflight7BBF8BFB",
                  "Arn"
                ]
              },
              "\",\"Payload.$\":\"$\"}},\"TakePayment\":{\"Next\":\"ConfirmHotelBooking\",\"Retry\":[{\"ErrorEquals\":[\"Lambda.ServiceException\",\"Lambda.AWSLambdaException\",\"Lambda.SdkClientException\"],\"IntervalSeconds\":2,\"MaxAttempts\":6,\"BackoffRate\":2}],\"Catch\":[{\"ErrorEquals\":[\"States.ALL\"],\"ResultPath\":\"$.TakePaymentError\",\"Next\":\"RefundPayment\"}],\"Type\":\"Task\",\"ResultPath\":\"$.TakePaymentResult\",\"Resource\":\"arn:",
              {
                "Ref": "AWS::Partition"
              },
              ":states:::lambda:invoke\",\"Parameters\":{\"FunctionName\":\"",
              {
                "Fn::GetAtt": [
                  "takePaymentLambdaHandlerB96529D4",
                  "Arn"
                ]
              },
              "\",\"Payload.$\":\"$\"}},\"ConfirmHotelBooking\":{\"Next\":\"ConfirmFlight\",\"Retry\":[{\"ErrorEquals\":[\"Lambda.ServiceException\",\"Lambda.AWSLambdaException\",\"Lambda.SdkClientException\"],\"IntervalSeconds\":2,\"MaxAttempts\":6,\"BackoffRate\":2}],\"Catch\":[{\"ErrorEquals\":[\"States.ALL\"],\"ResultPath\":\"$.ConfirmHotelBookingError\",\"Next\":\"RefundPayment\"}],\"Type\":\"Task\",\"ResultPath\":\"$.ConfirmHotelBookingResult\",\"Resource\":\"arn:",
              {
                "Ref": "AWS::Partition"
              },
              ":states:::lambda:invoke\",\"Parameters\":{\"FunctionName\":\"",
              {
                "Fn::GetAtt": [
                  "confirmHotelLambdaHandler882ACF2D",
                  "Arn"
                ]
              },
              "\",\"Payload.$\":\"$\"}},\"ConfirmFlight\":{\"Next\":\"We have made your booking!\",\"Retry\":[{\"ErrorEquals\":[\"Lambda.ServiceException\",\"Lambda.AWSLambdaException\",\"Lambda.SdkClientException\"],\"IntervalSeconds\":2,\"MaxAttempts\":6,\"BackoffRate\":2}],\"Catch\":[{\"ErrorEquals\":[\"States.ALL\"],\"ResultPath\":\"$.ConfirmFlightError\",\"Next\":\"RefundPayment\"}],\"Type\":\"Task\",\"ResultPath\":\"$.ConfirmFlightResult\",\"Resource\":\"arn:",
              {
                "Ref": "AWS::Partition"
              },
              ":states:::lambda:invoke\",\"Parameters\":{\"FunctionName\":\"",
              {
                "Fn::GetAtt": [
                  "confirmFlightLambdaHandler96C3663F",
                  "Arn"
                ]
              },
              "\",\"Payload.$\":\"$\"}},\"We have made your booking!\":{\"Type\":\"Succeed\"},\"RefundPayment\":{\"Next\":\"CancelFlightReservation\",\"Retry\":[{\"ErrorEquals\":[\"Lambda.ServiceException\",\"Lambda.AWSLambdaException\",\"Lambda.SdkClientException\"],\"IntervalSeconds\":2,\"MaxAttempts\":6,\"BackoffRate\":2},{\"ErrorEquals\":[\"States.ALL\"],\"MaxAttempts\":3}],\"Type\":\"Task\",\"ResultPath\":\"$.RefundPaymentResult\",\"Resource\":\"arn:",
              {
                "Ref": "AWS::Partition"
              },
              ":states:::lambda:invoke\",\"Parameters\":{\"FunctionName\":\"",
              {
                "Fn::GetAtt": [
                  "refundPaymentLambdaHandler932D11D5",
                  "Arn"
                ]
              },
              "\",\"Payload.$\":\"$\"}},\"CancelFlightReservation\":{\"Next\":\"CancelHotelReservation\",\"Retry\":[{\"ErrorEquals\":[\"Lambda.ServiceException\",\"Lambda.AWSLambdaException\",\"Lambda.SdkClientException\"],\"IntervalSeconds\":2,\"MaxAttempts\":6,\"BackoffRate\":2},{\"ErrorEquals\":[\"States.ALL\"],\"MaxAttempts\":3}],\"Type\":\"Task\",\"ResultPath\":\"$.CancelFlightReservationResult\",\"Resource\":\"arn:",
              {
                "Ref": "AWS::Partition"
              },
              ":states:::lambda:invoke\",\"Parameters\":{\"FunctionName\":\"",
              {
                "Fn::GetAtt": [
                  "cancelFlightLambdaHandler437EEC76",
                  "Arn"
                ]
              },
              "\",\"Payload.$\":\"$\"}},\"CancelHotelReservation\":{\"Next\":\"Sorry, We Couldn't make the booking\",\"Retry\":[{\"ErrorEquals\":[\"Lambda.ServiceException\",\"Lambda.AWSLambdaException\",\"Lambda.SdkClientException\"],\"IntervalSeconds\":2,\"MaxAttempts\":6,\"BackoffRate\":2},{\"ErrorEquals\":[\"States.ALL\"],\"MaxAttempts\":3}],\"Type\":\"Task\",\"ResultPath\":\"$.CancelHotelReservationResult\",\"Resource\":\"arn:",
              {
                "Ref": "AWS::Partition"
              },
              ":states:::lambda:invoke\",\"Parameters\":{\"FunctionName\":\"",
              {
                "Fn::GetAtt": [
                  "cancelHotelLambdaHandler09F13EF6",
                  "Arn"
                ]
              },
              "\",\"Payload.$\":\"$\"}},\"Sorry, We Couldn't make the booking\":{\"Type\":\"Fail\"}},\"TimeoutSeconds\":300}"
            ]
          ]
        }
      },
      "DependsOn": [
        "BookingSagaRoleDefaultPolicy6595FE9E",
        "BookingSagaRole82982544"
      ]
    },
    "sagaLambdaHandlerServiceRole7EB685BD": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com"
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "ManagedPolicyArns": [
          {
            "Fn::Join": [
              "",
              [
                "arn:",
                {
                  "Ref": "AWS::Partition"
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
              ]
            ]
          }
        ]
      }
    },
    "sagaLambdaHandlerServiceRoleDefaultPolicyFE9A40F4": {
      "Type": "AWS::IAM::Policy",
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": "states:StartExecution",
              "Effect": "Allow",
              "Resource": {
                "Ref": "BookingSagaFA991213"
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "PolicyName": "sagaLambdaHandlerServiceRoleDefaultPolicyFE9A40F4",
        "Roles": [
          {
            "Ref": "sagaLambdaHandlerServiceRole7EB685BD"
          }
        ]
      }
    },
    "sagaLambdaHandlerFC24742F": {
      "Type": "AWS::Lambda::Function",
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Ref": "AssetParameters8c25bcf969d5c44db3786e06e9654cbaeb8195315e50b77ec96e7a35924d3893S3Bucket3CA48617"
          },
          "S3Key": {
            "Fn::Join": [
              "",
              [
                {
                  "Fn::Select": [
                    0,
                    {
                      "Fn::Split": [
                        "||",
                        {
                          "Ref": "AssetParameters8c25bcf969d5c44db3786e06e9654cbaeb8195315e50b77ec96e7a35924d3893S3VersionKey880BCBF5"
                        }
                      ]
                    }
                  ]
                },
                {
                  "Fn::Select": [
                    1,
                    {
                      "Fn::Split": [
                        "||",
                        {
                          "Ref": "AssetParameters8c25bcf969d5c44db3786e06e9654cbaeb8195315e50b77ec96e7a35924d3893S3VersionKey880BCBF5"
                        }
                      ]
                    }
                  ]
                }
              ]
            ]
          }
        },
        "Role": {
          "Fn::GetAtt": [
            "sagaLambdaHandlerServiceRole7EB685BD",
            "Arn"
          ]
        },
        "Environment": {
          "Variables": {
            "statemachine_arn": {
              "Ref": "BookingSagaFA991213"
            }
          }
        },
        "Handler": "sagaLambda.handler",
        "Runtime": "nodejs12.x"
      },
      "DependsOn": [
        "sagaLambdaHandlerServiceRoleDefaultPolicyFE9A40F4",
        "sagaLambdaHandlerServiceRole7EB685BD"
      ]
    },
    "SagaPatternSingleTable288D85B3": {
      "Type": "AWS::ApiGateway::RestApi",
      "Properties": {
        "Name": "SagaPatternSingleTable"
      }
    },
    "SagaPatternSingleTableCloudWatchRole130684F0": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "apigateway.amazonaws.com"
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "ManagedPolicyArns": [
          {
            "Fn::Join": [
              "",
              [
                "arn:",
                {
                  "Ref": "AWS::Partition"
                },
                ":iam::aws:policy/service-role/AmazonAPIGatewayPushToCloudWatchLogs"
              ]
            ]
          }
        ]
      }
    },
    "SagaPatternSingleTableAccount4A29EC28": {
      "Type": "AWS::ApiGateway::Account",
      "Properties": {
        "CloudWatchRoleArn": {
          "Fn::GetAtt": [
            "SagaPatternSingleTableCloudWatchRole130684F0",
            "Arn"
          ]
        }
      },
      "DependsOn": [
        "SagaPatternSingleTable288D85B3"
      ]
    },
    "SagaPatternSingleTableDeployment96972FE73b8e3f63fd2a1f026cfd8fbfa1ec4404": {
      "Type": "AWS::ApiGateway::Deployment",
      "Properties": {
        "RestApiId": {
          "Ref": "SagaPatternSingleTable288D85B3"
        },
        "Description": "Automatically created by the RestApi construct"
      },
      "DependsOn": [
        "SagaPatternSingleTableproxyANY8778A55C",
        "SagaPatternSingleTableproxy9F7D6084",
        "SagaPatternSingleTableANYFE1A7CB0"
      ]
    },
    "SagaPatternSingleTableDeploymentStageprod92F0690D": {
      "Type": "AWS::ApiGateway::Stage",
      "Properties": {
        "RestApiId": {
          "Ref": "SagaPatternSingleTable288D85B3"
        },
        "DeploymentId": {
          "Ref": "SagaPatternSingleTableDeployment96972FE73b8e3f63fd2a1f026cfd8fbfa1ec4404"
        },
        "StageName": "prod"
      },
      "DependsOn": [
        "SagaPatternSingleTableAccount4A29EC28"
      ]
    },
    "SagaPatternSingleTableproxy9F7D6084": {
      "Type": "AWS::ApiGateway::Resource",
      "Properties": {
        "ParentId": {
          "Fn::GetAtt": [
            "SagaPatternSingleTable288D85B3",
            "RootResourceId"
          ]
        },
        "PathPart": "{proxy+}",
        "RestApiId": {
          "Ref": "SagaPatternSingleTable288D85B3"
        }
      }
    },
    "SagaPatternSingleTableproxyANYApiPermissionSagaStepFunctionSagaPatternSingleTable865F4F4DANYproxy4B878BCB": {
      "Type": "AWS::Lambda::Permission",
      "Properties": {
        "Action": "lambda:InvokeFunction",
        "FunctionName": {
          "Fn::GetAtt": [
            "sagaLambdaHandlerFC24742F",
            "Arn"
          ]
        },
        "Principal": "apigateway.amazonaws.com",
        "SourceArn": {
          "Fn::Join": [
            "",
            [
              "arn:",
              {
                "Ref": "AWS::Partition"
              },
              ":execute-api:",
              {
                "Ref": "AWS::Region"
              },
              ":",
              {
                "Ref": "AWS::AccountId"
              },
              ":",
              {
                "Ref": "SagaPatternSingleTable288D85B3"
              },
              "/",
              {
                "Ref": "SagaPatternSingleTableDeploymentStageprod92F0690D"
              },
              "/*/*"
            ]
          ]
        }
      }
    },
    "SagaPatternSingleTableproxyANYApiPermissionTestSagaStepFunctionSagaPatternSingleTable865F4F4DANYproxy35A08972": {
      "Type": "AWS::Lambda::Permission",
      "Properties": {
        "Action": "lambda:InvokeFunction",
        "FunctionName": {
          "Fn::GetAtt": [
            "sagaLambdaHandlerFC24742F",
            "Arn"
          ]
        },
        "Principal": "apigateway.amazonaws.com",
        "SourceArn": {
          "Fn::Join": [
            "",
            [
              "arn:",
              {
                "Ref": "AWS::Partition"
              },
              ":execute-api:",
              {
                "Ref": "AWS::Region"
              },
              ":",
              {
                "Ref": "AWS::AccountId"
              },
              ":",
              {
                "Ref": "SagaPatternSingleTable288D85B3"
              },
              "/test-invoke-stage/*/*"
            ]
          ]
        }
      }
    },
    "SagaPatternSingleTableproxyANY8778A55C": {
      "Type": "AWS::ApiGateway::Method",
      "Properties": {
        "HttpMethod": "ANY",
        "ResourceId": {
          "Ref": "SagaPatternSingleTableproxy9F7D6084"
        },
        "RestApiId": {
          "Ref": "SagaPatternSingleTable288D85B3"
        },
        "AuthorizationType": "NONE",
        "Integration": {
          "IntegrationHttpMethod": "POST",
          "Type": "AWS_PROXY",
          "Uri": {
            "Fn::Join": [
              "",
              [
                "arn:",
                {
                  "Ref": "AWS::Partition"
                },
                ":apigateway:",
                {
                  "Ref": "AWS::Region"
                },
                ":lambda:path/2015-03-31/functions/",
                {
                  "Fn::GetAtt": [
                    "sagaLambdaHandlerFC24742F",
                    "Arn"
                  ]
                },
                "/invocations"
              ]
            ]
          }
        }
      }
    },
    "SagaPatternSingleTableANYApiPermissionSagaStepFunctionSagaPatternSingleTable865F4F4DANY0DD5F6DB": {
      "Type": "AWS::Lambda::Permission",
      "Properties": {
        "Action": "lambda:InvokeFunction",
        "FunctionName": {
          "Fn::GetAtt": [
            "sagaLambdaHandlerFC24742F",
            "Arn"
          ]
        },
        "Principal": "apigateway.amazonaws.com",
        "SourceArn": {
          "Fn::Join": [
            "",
            [
              "arn:",
              {
                "Ref": "AWS::Partition"
              },
              ":execute-api:",
              {
                "Ref": "AWS::Region"
              },
              ":",
              {
                "Ref": "AWS::AccountId"
              },
              ":",
              {
                "Ref": "SagaPatternSingleTable288D85B3"
              },
              "/",
              {
                "Ref": "SagaPatternSingleTableDeploymentStageprod92F0690D"
              },
              "/*/"
            ]
          ]
        }
      }
    },
    "SagaPatternSingleTableANYApiPermissionTestSagaStepFunctionSagaPatternSingleTable865F4F4DANY4FBFDAA8": {
      "Type": "AWS::Lambda::Permission",
      "Properties": {
        "Action": "lambda:InvokeFunction",
        "FunctionName": {
          "Fn::GetAtt": [
            "sagaLambdaHandlerFC24742F",
            "Arn"
          ]
        },
        "Principal": "apigateway.amazonaws.com",
        "SourceArn": {
          "Fn::Join": [
            "",
            [
              "arn:",
              {
                "Ref": "AWS::Partition"
              },
              ":execute-api:",
              {
                "Ref": "AWS::Region"
              },
              ":",
              {
                "Ref": "AWS::AccountId"
              },
              ":",
              {
                "Ref": "SagaPatternSingleTable288D85B3"
              },
              "/test-invoke-stage/*/"
            ]
          ]
        }
      }
    },
    "SagaPatternSingleTableANYFE1A7CB0": {
      "Type": "AWS::ApiGateway::Method",
      "Properties": {
        "HttpMethod": "ANY",
        "ResourceId": {
          "Fn::GetAtt": [
            "SagaPatternSingleTable288D85B3",
            "RootResourceId"
          ]
        },
        "RestApiId": {
          "Ref": "SagaPatternSingleTable288D85B3"
        },
        "AuthorizationType": "NONE",
        "Integration": {
          "IntegrationHttpMethod": "POST",
          "Type": "AWS_PROXY",
          "Uri": {
            "Fn::Join": [
              "",
              [
                "arn:",
                {
                  "Ref": "AWS::Partition"
                },
                ":apigateway:",
                {
                  "Ref": "AWS::Region"
                },
                ":lambda:path/2015-03-31/functions/",
                {
                  "Fn::GetAtt": [
                    "sagaLambdaHandlerFC24742F",
                    "Arn"
                  ]
                },
                "/invocations"
              ]
            ]
          }
        }
      }
    }
  },
  "Parameters": {
    "AssetParameters21d94be1cd6f1e9584629e926200f4dbfcc73c09a2dfcd6f984254297c59c9f1S3Bucket3E022A35": {
      "Type": "String",
      "Description": "S3 bucket for asset \"21d94be1cd6f1e9584629e926200f4dbfcc73c09a2dfcd6f984254297c59c9f1\""
    },
    "AssetParameters21d94be1cd6f1e9584629e926200f4dbfcc73c09a2dfcd6f984254297c59c9f1S3VersionKey2F48AA09": {
      "Type": "String",
      "Description": "S3 key for asset version \"21d94be1cd6f1e9584629e926200f4dbfcc73c09a2dfcd6f984254297c59c9f1\""
    },
    "AssetParameters21d94be1cd6f1e9584629e926200f4dbfcc73c09a2dfcd6f984254297c59c9f1ArtifactHash95591980": {
      "Type": "String",
      "Description": "Artifact hash for asset \"21d94be1cd6f1e9584629e926200f4dbfcc73c09a2dfcd6f984254297c59c9f1\""
    },
    "AssetParameters8c25bcf969d5c44db3786e06e9654cbaeb8195315e50b77ec96e7a35924d3893S3Bucket3CA48617": {
      "Type": "String",
      "Description": "S3 bucket for asset \"8c25bcf969d5c44db3786e06e9654cbaeb8195315e50b77ec96e7a35924d3893\""
    },
    "AssetParameters8c25bcf969d5c44db3786e06e9654cbaeb8195315e50b77ec96e7a35924d3893S3VersionKey880BCBF5": {
      "Type": "String",
      "Description": "S3 key for asset version \"8c25bcf969d5c44db3786e06e9654cbaeb8195315e50b77ec96e7a35924d3893\""
    },
    "AssetParameters8c25bcf969d5c44db3786e06e9654cbaeb8195315e50b77ec96e7a35924d3893ArtifactHashC9C5765A": {
      "Type": "String",
      "Description": "Artifact hash for asset \"8c25bcf969d5c44db3786e06e9654cbaeb8195315e50b77ec96e7a35924d3893\""
    }
  },
  "Outputs": {
    "SagaPatternSingleTableEndpoint3B912404": {
      "Value": {
        "Fn::Join": [
          "",
          [
            "https://",
            {
              "Ref": "SagaPatternSingleTable288D85B3"
            },
            ".execute-api.",
            {
              "Ref": "AWS::Region"
            },
            ".",
            {
              "Ref": "AWS::URLSuffix"
            },
            "/",
            {
              "Ref": "SagaPatternSingleTableDeploymentStageprod92F0690D"
            },
            "/"
          ]
        ]
      }
    }
  },
  "Mappings": {
    "ServiceprincipalMap": {
      "af-south-1": {
        "states": "states.af-south-1.amazonaws.com"
      },
      "ap-east-1": {
        "states": "states.ap-east-1.amazonaws.com"
      },
      "ap-northeast-1": {
        "states": "states.ap-northeast-1.amazonaws.com"
      },
      "ap-northeast-2": {
        "states": "states.ap-northeast-2.amazonaws.com"
      },
      "ap-northeast-3": {
        "states": "states.ap-northeast-3.amazonaws.com"
      },
      "ap-south-1": {
        "states": "states.ap-south-1.amazonaws.com"
      },
      "ap-southeast-1": {
        "states": "states.ap-southeast-1.amazonaws.com"
      },
      "ap-southeast-2": {
        "states": "states.ap-southeast-2.amazonaws.com"
      },
      "ap-southeast-3": {
        "states": "states.ap-southeast-3.amazonaws.com"
      },
      "ca-central-1": {
        "states": "states.ca-central-1.amazonaws.com"
      },
      "cn-north-1": {
        "states": "states.cn-north-1.amazonaws.com"
      },
      "cn-northwest-1": {
        "states": "states.cn-northwest-1.amazonaws.com"
      },
      "eu-central-1": {
        "states": "states.eu-central-1.amazonaws.com"
      },
      "eu-north-1": {
        "states": "states.eu-north-1.amazonaws.com"
      },
      "eu-south-1": {
        "states": "states.eu-south-1.amazonaws.com"
      },
      "eu-south-2": {
        "states": "states.eu-south-2.amazonaws.com"
      },
      "eu-west-1": {
        "states": "states.eu-west-1.amazonaws.com"
      },
      "eu-west-2": {
        "states": "states.eu-west-2.amazonaws.com"
      },
      "eu-west-3": {
        "states": "states.eu-west-3.amazonaws.com"
      },
      "me-south-1": {
        "states": "states.me-south-1.amazonaws.com"
      },
      "sa-east-1": {
        "states": "states.sa-east-1.amazonaws.com"
      },
      "us-east-1": {
        "states": "states.us-east-1.amazonaws.com"
      },
      "us-east-2": {
        "states": "states.us-east-2.amazonaws.com"
      },
      "us-gov-east-1": {
        "states": "states.us-gov-east-1.amazonaws.com"
      },
      "us-gov-west-1": {
        "states": "states.us-gov-west-1.amazonaws.com"
      },
      "us-iso-east-1": {
        "states": "states.amazonaws.com"
      },
      "us-iso-west-1": {
        "states": "states.amazonaws.com"
      },
      "us-isob-east-1": {
        "states": "states.amazonaws.com"
      },
      "us-west-1": {
        "states": "states.us-west-1.amazonaws.com"
      },
      "us-west-2": {
        "states": "states.us-west-2.amazonaws.com"
      }
    }
  }
}